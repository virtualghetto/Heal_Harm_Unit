#textdomain wesnoth-Heal_Harm_Unit
[textdomain]
    name="wesnoth-Heal_Harm_Unit"
    path="data/add-ons/Heal_Harm_Unit/translations"
[/textdomain]

[modification]
    id=Heal_Harm_Unit
    name= _ "Heal/Harm units"
    description= _ "A modification to heal or harm units."
    require_modification=no
    type=hybrid

    [event]
        name=prestart

        [store_unit]
            [filter]
                [filter_side]
                    controller=human
                [/filter_side]
            [/filter]
            mode=always_clear
            variable=hhu.debbie_actor
        [/store_unit]
        [set_menu_item]
            id=debbie_actor_menu
            description= _ "Select Unit (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                [/have_unit]
            [/show_if]
            [command]
                [store_unit]
                    [filter]
                        x,y=$x1,$y1
                        id=$unit.id
                    [/filter]
                    mode=always_clear
                    variable=hhu.debbie_actor
                [/store_unit]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_heal_menu
            description= _ "Heal Unit (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                    [and]
                        [not]
                            [filter_wml]
                                hitpoints=$this_unit.max_hitpoints
                            [/filter_wml]
                        [/not]
                    [/and]
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            id=$hhu.debbie_actor.id
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.id
                            equals=$unit.id
                        [/variable]
                    [/not]
                    [then]
                        [heal_unit]
                            [filter]
                                x,y=$x1,$y1
                                id=$unit.id
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            amount=full
                            #moves=full
                            restore_attacks=no
                            restore_statuses=no
                            animate=yes
                        [/heal_unit]
                        [clear_variable]
                            name=heal_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_heal_side_menu
            description= _ "Heal Side (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            side=$hhu.debbie_actor.side
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.side
                            equals=$unit.side
                        [/variable]
                    [/not]
                    [then]
                        [heal_unit]
                            [filter]
                                side=$unit.side
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            amount=full
                            #moves=full
                            restore_attacks=no
                            restore_statuses=no
                            animate=yes
                        [/heal_unit]
                        [clear_variable]
                            name=heal_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_harm_menu
            description= _ "Harm Unit (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                    [and]
                        [not]
                            [filter_wml]
                                hitpoints=1
                            [/filter_wml]
                        [/not]
                    [/and]
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            id=$hhu.debbie_actor.id
                        [/have_unit]
                    [/not]
                [/and]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            side=$hhu.debbie_actor.side
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.id
                            equals=$unit.id
                        [/variable]
                    [/not]
                    [then]
                        [set_variable]
                            name=unit.hitpoints
                            sub=1
                        [/set_variable]
                        [harm_unit]
                            [filter]
                                x,y=$x1,$y1
                                id=$unit.id
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            [primary_attack]
                            [/primary_attack]
                            [secondary_attack]
                            [/secondary_attack]
                            amount=$unit.hitpoints
                            kill=no
                            animate=no
                            experience=yes
                            fire_event=yes
                            #delay=500
                            #poisoned=no
                            #slowed=no
                            #petrified=no
                            #unhealable=no
                        [/harm_unit]
                        [clear_variable]
                            name=harm_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_kill_menu
            description= _ "Kill Unit (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                    [and]
                        [filter_wml]
                            hitpoints=1
                        [/filter_wml]
                    [/and]
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            id=$hhu.debbie_actor.id
                        [/have_unit]
                    [/not]
                [/and]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            side=$hhu.debbie_actor.side
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.id
                            equals=$unit.id
                        [/variable]
                    [/not]
                    [then]
                        [harm_unit]
                            [filter]
                                x,y=$x1,$y1
                                id=$unit.id
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            [primary_attack]
                            [/primary_attack]
                            [secondary_attack]
                            [/secondary_attack]
                            amount=$unit.hitpoints
                            kill=yes
                            animate=no
                            experience=yes
                            fire_event=yes
                            #delay=500
                            #poisoned=no
                            #slowed=no
                            #petrified=no
                            #unhealable=no
                        [/harm_unit]
                        #[redraw][/redraw]
                        [clear_variable]
                            name=harm_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_harm_side_menu
            description= _ "Harm Side (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            side=$hhu.debbie_actor.side
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.side
                            equals=$unit.side
                        [/variable]
                    [/not]
                    [then]
                        [harm_unit]
                            [filter]
                                side=$unit.side
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            [primary_attack]
                            [/primary_attack]
                            [secondary_attack]
                            [/secondary_attack]
                            amount=$this_unit.hitpoints
                            kill=no
                            animate=no
                            experience=yes
                            fire_event=yes
                            #delay=500
                            #poisoned=no
                            #slowed=no
                            #petrified=no
                            #unhealable=no
                        [/harm_unit]
                        #[redraw][/redraw]
                        [clear_variable]
                            name=harm_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=debbie_kill_side_menu
            description= _ "Kill Side (Mod)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                    count=1
                    search_recall_list=no
                [/have_unit]
                [and]
                    [not]
                        [have_unit]
                            x,y=$x1,$y1
                            side=$hhu.debbie_actor.side
                        [/have_unit]
                    [/not]
                [/and]
            [/show_if]
            [command]
                [if]
                    [variable]
                        name=hhu.debbie_actor.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                [filter_side]
                                    controller=human
                                [/filter_side]
                            [/filter]
                            variable=hhu.debbie_actor
                        [/store_unit]
                    [/then]
                [/if]
                [if]
                    [not]
                        [variable]
                            name=hhu.debbie_actor.side
                            equals=$unit.side
                        [/variable]
                    [/not]
                    [then]
                        [harm_unit]
                            [filter]
                                side=$unit.side
                            [/filter]
                            [filter_second]
                                id=$hhu.debbie_actor.id
                            [/filter_second]
                            [primary_attack]
                            [/primary_attack]
                            [secondary_attack]
                            [/secondary_attack]
                            amount=$this_unit.hitpoints
                            kill=yes
                            animate=no
                            experience=yes
                            fire_event=yes
                            #delay=500
                            #poisoned=no
                            #slowed=no
                            #petrified=no
                            #unhealable=no
                        [/harm_unit]
                        #[redraw][/redraw]
                        [clear_variable]
                            name=harm_amount
                        [/clear_variable]
                    [/then]
                [/if]
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=scenario_end
        [clear_variable]
            name=hhu.debbie_actor
        [/clear_variable]
        [clear_menu_item]
            id=debbie_heal_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_harm_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_kill_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_harm_side_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_heal_side_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_kill_side_menu
        [/clear_menu_item]
        [clear_menu_item]
            id=debbie_actor_menu
        [/clear_menu_item]
    [/event]
[/modification]

[modification]
    id=Mod_Invincible
    name= _ "Mod Invincible"
    description= _ "A modification to make human side invincible."
    require_modification=no
    type=hybrid

    [event]
        name=prestart

        #        {MOD_INVINCIBLE (
        #            [filter_side]
        #                controller=human
        #            [/filter_side]
        #        ) (
        #            [filter_side]
        #                controller=ai
        #            [/filter_side]
        #        )}

        # # define MOD_INVINCIBLE FILTER SECOND_FILTER
        [event]
            name=attack
            id=mod_invincible_attack
            first_time_only=no
            [filter]
                #{FILTER}
                [filter_side]
                    controller=human
                [/filter_side]
            [/filter]
            [filter_second]
                #{SECOND_FILTER}
                [filter_side]
                    controller=ai
                [/filter_side]
            [/filter_second]
            [filter_condition]
                {VARIABLE_CONDITIONAL mod_invincible numerical_equals 1}
            [/filter_condition]
            [modify_unit]
                [filter]
                    id=$unit.id
                [/filter]
                [effect]
                    apply_to=status
                    add=invulnerable
                [/effect]
            [/modify_unit]
            [event]
                name=attack end
                delayed_variable_substitution=yes
                [if]
                    [variable]
                        name=unit.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        # Unit vanished mid-fight
                        [return][/return]
                    [/then]
                [/if]
                [modify_unit]
                    [filter]
                        id=$unit.id
                    [/filter]
                    [effect]
                        apply_to=status
                        remove=invulnerable
                    [/effect]
                [/modify_unit]
            [/event]
        [/event]
        [event]
            name=attack
            id=mod_invincible_defend
            first_time_only=no
            [filter]
                #{SECOND_FILTER}
                [filter_side]
                    controller=ai
                [/filter_side]
            [/filter]
            [filter_second]
                #{FILTER}
                [filter_side]
                    controller=human
                [/filter_side]
            [/filter_second]
            [filter_condition]
                {VARIABLE_CONDITIONAL mod_invincible numerical_equals 1}
            [/filter_condition]
            [modify_unit]
                [filter]
                    id=$second_unit.id
                [/filter]
                [effect]
                    apply_to=status
                    add=invulnerable
                [/effect]
            [/modify_unit]
            [event]
                name=attack end
                delayed_variable_substitution=yes
                [if]
                    [variable]
                        name=second_unit.length
                        numerical_equals=0
                    [/variable]
                    [then]
                        # Unit vanished mid-fight
                        [return][/return]
                    [/then]
                [/if]
                [modify_unit]
                    [filter]
                        id=$second_unit.id
                    [/filter]
                    [effect]
                        apply_to=status
                        remove=invulnerable
                    [/effect]
                [/modify_unit]
            [/event]
        [/event]
        # # enddef

        [set_menu_item]
            id=mod_invincible_on
            description= _ "Toggle Invincible (On)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [not]
                    {VARIABLE_CONDITIONAL mod_invincible numerical_equals 1}
                [/not]
                [have_unit]
                    x,y=$x1,$y1
                    count=0
                    search_recall_list=no
                [/have_unit]
            [/show_if]
            [command]
                {VARIABLE mod_invincible 1}
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=mod_invincible_off
            description= _ "Toggle Invincible (Off)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                {VARIABLE_CONDITIONAL mod_invincible numerical_equals 1}
                [have_unit]
                    x,y=$x1,$y1
                    count=0
                    search_recall_list=no
                [/have_unit]
            [/show_if]
            [command]
                {VARIABLE mod_invincible 0}
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=scenario_end
        [clear_variable]
            name=mod_invincible
        [/clear_variable]
        [clear_menu_item]
            id=mod_invincible_on
        [/clear_menu_item]
        [clear_menu_item]
            id=mod_invincible_off
        [/clear_menu_item]
    [/event]
[/modification]

[modification]
    id=Mod_Exploration
    name= _ "Mod Exploration"
    description= _ "A modification that allows human side explore the map."
    require_modification=no
    type=hybrid

    [event]
        name=prestart

        [event]
            name=moveto
            first_time_only=no
            id=mod_exploration_moveto
            [filter]
                x,y=$x1,$y1
                [filter_side]
                    controller=human
                [/filter_side]
            [/filter]
            [filter_condition]
                {VARIABLE_CONDITIONAL mod_exploration numerical_equals 1}
            [/filter_condition]
            [heal_unit]
                [filter]
                    id=$unit.id
                [/filter]
                amount=0
                restore_statuses=no
                moves=full
            [/heal_unit]
            {CLEAR_VARIABLE heal_amount}
        [/event]

        [set_menu_item]
            id=mod_exploration_on
            description= _ "Toggle Exploration (On)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [not]
                    {VARIABLE_CONDITIONAL mod_exploration numerical_equals 1}
                [/not]
                [have_unit]
                    x,y=$x1,$y1
                    count=0
                    search_recall_list=no
                [/have_unit]
            [/show_if]
            [command]
                {VARIABLE mod_exploration 1}
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=mod_exploration_off
            description= _ "Toggle Exploration (Off)"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                {VARIABLE_CONDITIONAL mod_exploration numerical_equals 1}
                [have_unit]
                    x,y=$x1,$y1
                    count=0
                    search_recall_list=no
                [/have_unit]
            [/show_if]
            [command]
                {VARIABLE mod_exploration 0}
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=scenario_end
        [clear_variable]
            name=mod_exploration
        [/clear_variable]
        [clear_menu_item]
            id=mod_exploration_on
        [/clear_menu_item]
        [clear_menu_item]
            id=mod_exploration_off
        [/clear_menu_item]
    [/event]
[/modification]

[modification]
    id=Mod_ShowID
    name= _ "Mod Show ID"
    description= _ "A modification to show unit ID and role."
    require_modification=no
    type=hybrid

    [event]
        name=prestart

        [set_menu_item]
            id=mod_showid
            description= _ "Show ID"
            image=misc/blank-hex.png~SCALE(1,1)
            [show_if]
                [have_unit]
                    x,y=$x1,$y1
                [/have_unit]
            [/show_if]
            [command]
		[message]
			speaker=unit
			message="My ID is $unit.id| and my role is $unit.role| ."
		[/message]
            [/command]
        [/set_menu_item]
    [/event]

    [event]
        name=scenario_end
        [clear_menu_item]
            id=mod_showid
        [/clear_menu_item]
    [/event]
[/modification]
